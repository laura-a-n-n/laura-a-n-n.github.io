{"mappings":"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","sources":["public/src/client/player.js"],"sourcesContent":["// function isCyclic (obj) {\r\n//   var seenObjects = [];\r\n\r\n//   function detect (obj) {\r\n//     if (obj && typeof obj === 'object') {\r\n//       if (seenObjects.indexOf(obj) !== -1) {\r\n//         return true;\r\n//       }\r\n//       seenObjects.push(obj);\r\n//       for (var key in obj) {\r\n//         if (obj.hasOwnProperty(key) && detect(obj[key])) {\r\n//           console.log(obj, 'cycle at ' + key);\r\n//           return true;\r\n//         }\r\n//       }\r\n//     }\r\n//     return false;\r\n//   }\r\n\r\n//   return detect(obj);\r\n// }\r\n\r\nclass Player {\r\n\tconstructor(cam, characterClass) { \r\n\t    // essentials\r\n\t    this.cam = cam;\r\n\t    this.characterProfile = [];\r\n\t    this.characterClass = characterClass;\r\n\t    \r\n\t    // game properties\r\n\t    this.mouseMode = 'split'; // 'split' or 'character'\r\n\t    this.pointingLeft = false;\r\n\r\n\t    // inventory\r\n\t    this.inventory = {};\r\n\r\n\t    // initialize quests\r\n\t    this.initQuests();\r\n\r\n\t    // gui\r\n\t    this.gui = new GUI();\r\n\r\n\t    // number style\r\n\t    this.numberColor = color(255);\r\n\t    this.numOffsetY = 70;\r\n\t    this.numOffsetX = 0;\r\n\r\n\t    // show special number?\r\n\t    this.specialNumber = false;\r\n\t    this.specialLily = 0;\r\n\t    this.sizeSpecial = 40;\r\n\t    this.specialOffX = 30;\r\n\t    this.specialOffY = 70;\r\n\r\n\t    // fade screen\r\n\t    this.isFading = false;\r\n\t    this.fadeFrames = 0;\r\n\t    this.fadeTime = 3;\r\n\t}\r\n\r\n\tget hasQuest() {\r\n\t\treturn this.currentQuest > -1;\r\n\t}\r\n\r\n\tinstantiateCharacter() {\r\n\t\tthis.character = new this.characterClass(...this.characterProfile);\r\n\t\tthis.character.scale = this.cam.scale;\r\n\t\tfrogs[0] = this.character;\r\n\r\n    // number binds\r\n    this.binds = {\r\n    \t'Q': this.character.typeBind(1),\r\n    \t'W': this.character.typeBind(2),\r\n    \t'E': this.character.typeBind(3),\r\n    \t'R': this.character.typeBind(4)\r\n    }\r\n\r\n\t\treturn this.character;\r\n\t}\r\n\r\n\tresetCharacter() {\r\n\t\tthis.instantiateCharacter();\r\n\t\tthis.initQuests();\r\n\r\n\t\tthis.cam.target = this.character;\r\n\t}\r\n\r\n\tassignQuest(quest) {\r\n\t\tthis.questList.push(new quest(player));\r\n  \t\tthis.currentQuest = 0;\r\n\t}\r\n\r\n\tinitQuests() {\r\n\t    this.questList = [];\r\n\t    this.currentQuest = -1; // -1 is no quest\r\n\t    this.questDecayFrames = 0;\r\n\t    this.maxQuestFrames = 100;\r\n\t}\r\n\r\n\t/* frame */\r\n\r\n\tframe() {\r\n\t\tconst charCamCoords = this.cam.toCamCoords(this.character.posX, this.character.posY);\r\n\t\t\r\n\t\tthis.pointingLeft = (mouseX < charCamCoords[0]); // (mouseX < screenSizeX / 2) || ;\r\n\t\tthis.character.environment.envDependentFrame(this);\r\n\r\n\t\tif (this.hasQuest) {\r\n\t\t\tif (this.questList[this.currentQuest].frame()) {\r\n\t\t\t\t// if success, fade out quest window\r\n\t\t\t\tthis.questDecayFrames++;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.questDecayFrames > 0) this.questDecayFrames++;\r\n\r\n\t\t\tif (this.questDecayFrames > this.maxQuestFrames) {\r\n\t\t\t\tthis.questDecayFrames = 0;\r\n\t\t\t\tthis.questList.slice(this.currentQuest, 1);\r\n\t\t\t\tthis.currentQuest = -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// reset?\r\n\t\tif (this.character.tooHungry && !this.isFading) {\r\n\t\t\tcontrolsEnabled = false;\r\n\t\t\tthis.cam.guiOptions.helpLines = false;\r\n\r\n\t\t\tthis.isFading = true;\r\n\r\n\t\t    // bugs\r\n\t\t    this.bugsN = 4;\r\n\t\t    this.bugsX = Array(this.bugsN).fill(0);\r\n\t\t    this.bugsY = Array(this.bugsN).fill(0);\r\n\t\t    this.bugsTX = Array(this.bugsN).fill(1);\r\n\t\t    this.bugsTY = Array(this.bugsN).fill(-1);\r\n\t\t    this.beeSprite = Array(this.bugsN);\r\n\r\n\t\t    for (let i = 0; i < this.bugsN; i++) {\r\n\t\t      this.bugsX[i] = Math.floor(Math.random() * screenSizeX);\r\n\t\t      this.bugsY[i] = Math.floor(Math.random() * screenSizeY);\r\n\t\t      this.bugsTX[i] = (Math.random() > .5) ? 1 : -1;\r\n\t\t      this.bugsTY[i] = (Math.random() > .5) ? 1 : -1;\r\n\t\t    }\r\n\r\n\t\t} if (this.isFading && this.fadeFrames < this.fadeTime) { \r\n\t\t\tthis.fadeFrames += deltaTime / 1000;\r\n\t\t\tthis.character.posY += 10;\r\n\t\t\tthis.quitReady = true;\r\n\t\t} \r\n\t\tif (this.isFading) {\r\n\t\t    // update bugs\r\n\t\t    for (let i = 0; i < this.bugsN; i++) {\r\n\t\t      this.bugsX[i] += this.bugsTX[i];\r\n\t\t      this.bugsY[i] += this.bugsTY[i];\r\n\r\n\t\t      if (this.bugsX[i] > screenSizeX) this.bugsTX[i] = -1;\r\n\t\t      else if (this.bugsX[i] < 0) this.bugsTX[i] = 1;\r\n\r\n\t\t      if (this.bugsY[i] > screenSizeY) this.bugsTY[i] = -1;\r\n\t\t      else if (this.bugsY[i] < 0) this.bugsTY[i] = 1;\r\n\r\n\t\t      let baseName = (Math.floor(frameCount / 60) % 2 == 0) ? 'smallBee' : 'smallBeeWing';\r\n\t\t      let appended = (this.bugsTX[i] == 1) ? 'Right' : 'Left';\r\n\t\t      this.beeSprite[i] = baseName + appended;\r\n\t\t    }\r\n\t\t}\r\n\r\n\t\t// server\r\n\t\t//if (this.character.isJumping) socket.emit('frame', [player.character.posX, player.character.posY]);\r\n\t}\r\n\r\n\t/* draw */\r\n\r\n\tdrawHunger() {\r\n\t\tconst camFrogPos = this.cam.toCamCoords(this.character.posX, this.character.posY);\r\n\r\n\t  const hungerBarWidth = gfx['flyBar'].width;\r\n\t\tconst hungerBarHeight = gfx['flyBar'].height;\r\n\t  const hungerRatio = 1 - (frog.hunger / frog.maxHunger);\r\n\r\n\t  fill(0);\r\n\t  stroke(0);\r\n\t  // textSize(24);\r\n\t  // textFont(pixelFont);\r\n\t  // text('Hunger', screenSizeX - 1.3 * gfx['flyBar'].width, 25);\r\n\r\n\t  if (frog.hungry) {\r\n\t    push();\r\n\t    tint(255, 255 * Math.cos(2 * frameCount / 60));\r\n\t    image(gfx['flyBubble'], camFrogPos[0] + frog.dimX, camFrogPos[1] - frog.dimY,\r\n\t          gfx['flyBubble'].width * cam.scale, gfx['flyBubble'].height * cam.scale);\r\n\t    pop();\r\n\t  }\r\n\r\n\t  if (frog.ateThisFrame) {\r\n\t    frog.showHeart.push(1);\r\n\t  }\r\n\r\n\t  for (const heart in frog.showHeart) {\r\n\t    if (frog.showHeart[heart] > 0) {\r\n\t      frog.showHeart[heart]++;\r\n\t      image(gfx['heart'], camFrogPos[0] + frog.dimX, camFrogPos[1] - frog.dimY - frog.showHeart[heart] / 2,\r\n\t            gfx['heart'].width * cam.scale, gfx['heart'].height * cam.scale);\r\n\t      frog.showHeart[heart] %= frog.heartFrames;\r\n\t    } else {\r\n\t      frog.showHeart.splice(heart, 1);\r\n\t    }\r\n\t  }\r\n\r\n\t  push();\r\n\t  translate(screenSizeX - gfx['flyBar'].width - 5, 10);\r\n\t  fill(255);\r\n\t  stroke(0);\r\n\t  rect(-5, -10, hungerBarWidth + 10, hungerBarHeight + 20, 20);\r\n\t  image(gfx['flyBarGrey'], 0, 0);\r\n\t  if (hungerRatio * hungerBarWidth >= 1) {\r\n\t\t  const flyBar = gfx['flyBar'].get(0, 0, Math.floor(hungerRatio * hungerBarWidth), hungerBarHeight);\r\n\t\t  image(flyBar, 0, 0);\r\n\t  }\r\n\t  pop();\r\n\t}\r\n\r\n\tdrawQuest(quest) {\r\n\t  const opacity = 255 * (1 - this.questDecayFrames / this.maxQuestFrames);\r\n\t  quest.gui.draw(opacity);\r\n\r\n\t  push();\r\n\t  quest.draw(gfx, opacity);\r\n\t  pop();\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tpush();\r\n\t\t// main gui\r\n\t\tthis.gui.draw();\r\n\r\n\r\n\t    /* ~ additional hunger handler ~ */\r\n\t    if (this.character.tooHungry) {\r\n\t    \tlet fadeOpacity = this.fadeFrames / this.fadeTime;\r\n\t     \tbackground(0, 255 * fadeOpacity);\r\n\r\n\t\t\tpush();\r\n\t\t\ttranslate(screenSizeX / 2, 0);\r\n\t\t\tlet textCol = color(255, 255 * Math.pow(fadeOpacity, 8));\r\n\t\t\tfill(textCol);\r\n\t\t\tstroke(textCol);\r\n\t\t\ttextSize(64);\r\n\t\t\ttextAlign(CENTER);\r\n\t\t\ttextFont(pixelFont);\r\n\t\t\ttext('Oh dear! :(', 0, screenSizeY / 5);\r\n\t\t\ttext('You\\'re too hungry.', 0, screenSizeY / 3);\r\n\t\t\ttextSize(32);\r\n\t\t\ttext('Crab says it\\'s okay! Try again later?', 0, screenSizeY / 2 + gfx.crab.height * 1.25)\r\n\t\t\ttext('Click to restart the demo...', 0, screenSizeY - 32);\r\n\t\t\ttint(255, 255 * fadeOpacity);\r\n\t\t\timage(gfx.crab, -gfx.crab.width / 2, screenSizeY / 2);\r\n\t\t\tpop();\r\n\r\n\t\t    // bugs >-<\r\n\t\t    push();\r\n\t\t    if (this.fadeFrames < this.fadeTime) tint(255, 255 * fadeOpacity);\r\n\t\t    scale(.25);\r\n\t\t    for (let i = 0; i < this.bugsN; i++) {\r\n\t\t        image(gfx[this.beeSprite[i]], this.bugsX[i] / .25, this.bugsY[i] / .25);\r\n\t\t    }\r\n\t\t    pop();\r\n\t\t}\r\n\r\n\t\t// hunger gui\r\n\t\tthis.drawHunger();\r\n\r\n\t\t// quest gui\r\n\t\tif (this.currentQuest > -1) {\r\n\t\t\tthis.drawQuest(this.questList[this.currentQuest]);\r\n\t\t}\r\n\r\n\t  // frog gui\r\n\t  this.character.scale = this.cam.scale;\r\n\r\n\t\t// help lines\r\n\t\tif (this.cam.guiOptions.helpLines && this.character.type != 0) {\r\n\t\t  if (!this.character.isJumping) {\r\n\t\t    let pointDir = this.character.pointingLeft ? -1 : 1;\r\n\r\n\t\t    let startPosX = this.character.posX + this.character.dimX / 2;\r\n\t\t    let jumpDest = lilies.getLilyPos(this.character.lily + pointDir * this.character.type);\r\n\t\t    let jumpDestX = jumpDest[0] + this.character.dimX / 2 + this.character.offX;\t\t    \r\n\t\t    let jumpDestY = jumpDest[1] + this.character.offY;\r\n\r\n\t\t    this.curveParams = [startPosX, this.character.posY + this.character.dimY / 2,\r\n\t\t        (startPosX + jumpDestX) / 2, ((this.character.posY < jumpDestY) ? this.character.posY : jumpDestY) - this.character.jumpHeight + this.character.dimY / 2, \r\n\t\t        jumpDestX, jumpDestY + this.character.dimY]\r\n\t\t  }\r\n\r\n\t\t  const camCurveParams = [];\r\n\r\n\t\t  for (let k = 0; k < 3; k++) {\r\n\t\t    let pt = [this.curveParams[2 * k], this.curveParams[2 * k + 1]];\r\n\r\n\t\t    [camCurveParams[2 * k], camCurveParams[2 * k + 1]] = this.cam.toCamCoords(...pt);\r\n\t\t  }\r\n\r\n\t\t  const allCurves = [camCurveParams];\r\n\r\n\t\t  push();\r\n\t\t  setLineDash([5, 5]);\r\n\t\t  stroke(255, 128);\r\n\t\t  strokeWeight(3);\r\n\t\t  fill(0, 0, 0, 0);\r\n\r\n\t\t  let drawDot = true;\r\n\t\t  \r\n\t\t  for (const params of allCurves) {\r\n\t\t    switch (envType) {\r\n\t\t      case 'LinearLilies':\r\n\t\t        beginShape();\r\n\t\t        curveVertex(params[0], params[1]);\r\n\t\t        curveVertex(params[0], params[1]);\r\n\t\t        curveVertex(params[2], params[3]);\r\n\t\t        curveVertex(params[4], params[5]);\r\n\t\t        curveVertex(params[4], params[5]);\r\n\t\t        endShape();\r\n\r\n\t\t        break;\r\n\t\t      case 'CyclicLilies':\r\n\t\t        if (!this.character.isJumping) { \r\n\t\t          line(params[0], params[1], params[4], params[5]);\r\n\t\t        } else drawDot = false;\r\n\t\t    }\r\n\r\n\t\t    if (drawDot) {\r\n\t\t      strokeWeight(7 * this.cam.scale);\r\n\t\t      point(params[4], params[5]);\r\n\t\t    }\r\n\t\t  }\r\n\r\n\t\t  pop();\r\n\t\t}\r\n\r\n\t\t// number\r\n\t\tif (!this.character.tooHungry) {\r\n\t\t\tpush();\r\n\r\n\t\t\tif (this.character.changeNumber) {\r\n\t\t\t    this.numText = str(this.character.number);\r\n\t\t\t    this.lilyCamDiff = this.character.lilyPos;\r\n\t\t\t    this.lilyCamDiff[0] += 2 * this.numText.length + this.numOffsetX;\r\n\t\t\t    this.character.changeNumber = false;\r\n\t\t\t}\r\n\r\n\t\t\ttextFont(pixelFont);\r\n\t\t\tstroke(this.numberColor);\r\n\t\t\tfill(this.numberColor);\r\n\t\t\ttextSize(this.sizeSpecial * this.cam.scale * (1 - this.numText.length / 10));\r\n\t\t\ttext(this.numText, ...this.cam.toCamCoords(this.lilyCamDiff[0], this.lilyCamDiff[1] + this.numOffsetY * this.cam.scale));\r\n\r\n\t\t\tif (this.specialNumber) {\r\n\t\t\t\tlet specialPos = this.cam.toCamCoords(...this.character.environment.getLilyPos(this.specialLily));\r\n\t\t\t\tspecialPos[0] += this.specialOffX - 2 * this.specialLily.toString().length;\r\n\t\t\t\tspecialPos[1] += this.specialOffY * cam.scale;\r\n\r\n\t\t\t\ttext(this.specialLily.toString(), ...specialPos);\r\n\t\t\t}\r\n\r\n\t\t\tpop();\r\n\t\t}\r\n\t}\r\n}"],"names":["Player","constructor","cam","characterClass","this","characterProfile","mouseMode","pointingLeft","inventory","initQuests","gui","GUI","numberColor","color","numOffsetY","numOffsetX","specialNumber","specialLily","sizeSpecial","specialOffX","specialOffY","isFading","fadeFrames","fadeTime","hasQuest","currentQuest","instantiateCharacter","character","scale","frogs","binds","Q","typeBind","W","E","R","resetCharacter","target","assignQuest","quest","questList","push","player","questDecayFrames","maxQuestFrames","frame","charCamCoords","toCamCoords","posX","posY","mouseX","environment","envDependentFrame","slice","tooHungry","controlsEnabled","guiOptions","helpLines","bugsN","bugsX","Array","fill","bugsY","bugsTX","bugsTY","beeSprite","i","Math","floor","random","screenSizeX","screenSizeY","deltaTime","quitReady","baseName","frameCount","appended","drawHunger","camFrogPos","hungerBarWidth","gfx","width","hungerBarHeight","height","hungerRatio","frog","hunger","maxHunger","stroke","hungry","tint","cos","image","dimX","dimY","pop","ateThisFrame","showHeart","heart","heartFrames","splice","translate","rect","flyBar","get","drawQuest","opacity","draw","fadeOpacity","background","textCol","pow","textSize","textAlign","CENTER","textFont","pixelFont","text","crab","type","isJumping","pointDir","startPosX","jumpDest","lilies","getLilyPos","lily","jumpDestX","offX","jumpDestY","offY","curveParams","jumpHeight","camCurveParams","k","pt","allCurves","setLineDash","strokeWeight","drawDot","params","envType","beginShape","curveVertex","endShape","line","point","changeNumber","numText","str","number","lilyCamDiff","lilyPos","length","specialPos","toString"],"version":3,"file":"index.91f44925.js.map"}