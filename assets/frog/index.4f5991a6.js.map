{"mappings":"AAAA,MAAMA,MACLC,YAAYC,EACTC,EACAC,EACAC,EACAC,EACAC,GACFC,KAAKN,SAAWA,EAChBM,KAAKL,YAAcA,EACnBK,KAAKJ,QAAUA,EACfI,KAAKH,eAAiBA,EACtBG,KAAKF,aAAeA,EACpBE,KAAKC,QAAUH,EACfE,KAAKD,KAAOA,EACZC,KAAKE,SAAU,EACfF,KAAKG,gBAAiB,EAEtBH,KAAKI,gBACLJ,KAAKL,cAGNS,gBACCJ,KAAKK,YAAc,CAACC,YAAcC,IAAY,OAAEC,MAAQ,EAAI,EAAIC,YAAc,IAC9ET,KAAKU,aAAe,CAACH,IAAY,OAAEC,MAAOC,YAAc,GACxDT,KAAKW,eAAiB,EACtBX,KAAKY,IAAM,IAAIC,aAAab,KAAKK,eAAgBL,KAAKU,aAC/CV,KAAKW,eAAgB,QAASX,KAAKC,SAG3Ca,QAMC,OALAd,KAAKY,IAAIX,QAAUD,KAAKC,QAEnBD,KAAKE,QACLF,KAAKH,iBADSG,KAAKJ,UAGjBI,KAAKE,SAId,MAAMa,iBAAiBvB,MACtBC,YAAYC,GACXsB,MACCtB,GAEA,WACCM,KAAKiB,WAAa,EAClBjB,KAAKkB,UAAY,EACjBlB,KAAKmB,UAAW,KAGjB,YACMnB,KAAKmB,UAAYnB,KAAKN,SAAS0B,UAAUC,cACN,OAApCrB,KAAKN,SAAS0B,UAAUE,UAC3BtB,KAAKmB,UAAW,EAChBnB,KAAKiB,cACKjB,KAAKmB,WAAanB,KAAKN,SAAS0B,UAAUC,eACpDrB,KAAKmB,UAAW,GAGbnB,KAAKiB,YAAcjB,KAAKkB,YAC3BlB,KAAKE,SAAU,EACfF,KAAKH,kBAGNG,KAAKC,QAAUD,KAAKF,aAAe,KAAKE,KAAKiB,gBAAgBjB,KAAKkB,eAGnE,WACMlB,KAAKG,iBACTH,KAAKG,gBAAiB,EACtBH,KAAKC,QAAU,WAEfsB,aAAaC,gBAIf,gBAEA,SAASjB,EAAKkB,GACb,IAAK,IAAIC,EAAI,EAAGA,EAAI1B,KAAKkB,UAAWQ,IACnCC,OACAC,UAAU5B,KAAKY,IAAIiB,EAAI7B,KAAKY,IAAIkB,EAAI,EAAI,IAAMvB,EAAS,IAAEC,MAAOR,KAAKY,IAAImB,EAAI,EAAI/B,KAAKY,IAAIoB,EAAI,GAC9FC,KAAK,IAAKR,GAAW,GAAK,IAAMC,EAAI1B,KAAKiB,WAAa,EAAI,KAC1DiB,MAAM3B,EAAS,IAAGA,EAAS,IAAEC,MAAQkB,EAAG,GACxCS","sources":["public/src/client/quest.js"],"sourcesContent":["class Quest {\r\n\tconstructor(assignee,\r\n\t\t\t\tinitializer,\r\n\t\t\t\thandler,\r\n\t\t\t\tsuccessHandler,\r\n\t\t\t\tquestMessage,\r\n\t\t\t\tdraw) {\r\n\t\tthis.assignee = assignee;\r\n\t\tthis.initializer = initializer;\r\n\t\tthis.handler = handler;\r\n\t\tthis.successHandler = successHandler;\r\n\t\tthis.questMessage = questMessage;\r\n\t\tthis.message = questMessage;\r\n\t\tthis.draw = draw;\r\n\t\tthis.success = false;\r\n\t\tthis.successHandled = false;\r\n\r\n\t\tthis.calcGUIBounds();\r\n\t\tthis.initializer();\r\n\t}\r\n\r\n\tcalcGUIBounds() {\r\n\t\tthis.questBoxPos = [screenSizeX - gfx['flyBar'].width - 5,  1 * screenSizeY / 16];\r\n\t\tthis.questBoxSize = [gfx['flyBar'].width, screenSizeY / 4];\r\n\t\tthis.questBoxMargin = 6;\r\n\t\tthis.gui = new GUIWindow(...this.questBoxPos, ...this.questBoxSize,\r\n\t\t\t\t\t\t\t\t this.questBoxMargin, 'Quest', this.message);\r\n\t}\r\n\r\n\tframe() {\r\n\t\tthis.gui.message = this.message;\r\n\r\n\t\tif (!this.success) this.handler();\r\n\t\telse this.successHandler();\r\n\r\n\t\treturn this.success;\r\n\t}\r\n}\r\n\r\nclass FlyQuest extends Quest {\r\n\tconstructor(assignee) {\r\n\t\tsuper(\r\n\t\t\tassignee,\r\n\r\n\t\t\tfunction() {\r\n\t\t\t\tthis.fliesEaten = 0;\r\n\t\t\t\tthis.needToEat = 3;\r\n\t\t\t\tthis.flyEaten = false;\r\n\t\t\t},\r\n\r\n\t\t\tfunction() {\r\n\t\t\t\tif (!this.flyEaten && this.assignee.character.ateThisFrame\r\n\t\t\t\t\t&& this.assignee.character.foodName == 'fly') {\r\n\t\t\t\t\tthis.flyEaten = true;\r\n\t\t\t\t\tthis.fliesEaten++;\r\n\t\t\t\t} else if (this.flyEaten && !this.assignee.character.ateThisFrame) {\r\n\t\t\t\t\tthis.flyEaten = false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.fliesEaten >= this.needToEat) {\r\n\t\t\t\t\tthis.success = true;\r\n\t\t\t\t\tthis.successHandler();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.message = this.questMessage + `\\n${this.fliesEaten} / ${this.needToEat}`;\r\n\t\t\t},\r\n\r\n\t\t\tfunction() {\r\n\t\t\t\tif (!this.successHandled) {\r\n\t\t\t\t\tthis.successHandled = true;\r\n\t\t\t\t\tthis.message = 'Blessed!';\r\n\t\t\t\t\t\r\n\t\t\t\t\tgeneralState.wizardAnim();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t'Eat 3 flies!',\r\n\r\n\t\t\tfunction(gfx, opacity) {\r\n\t\t\t\tfor (let i = 0; i < this.needToEat; i++) {\r\n\t\t\t\t\tpush();\r\n\t\t\t\t\ttranslate(this.gui.x + this.gui.w / 2 - 1.5 * gfx['fly'].width, this.gui.y + 4 * this.gui.h / 5);\r\n\t\t\t\t\ttint(255, opacity * (.5 + .5 * (i < this.fliesEaten ? 1 : 0)));\r\n\t\t\t\t\timage(gfx['fly'], gfx['fly'].width * i, 0);\r\n\t\t\t\t\tpop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n}"],"names":["Quest","constructor","assignee","initializer","handler","successHandler","questMessage","draw","this","message","success","successHandled","calcGUIBounds","questBoxPos","screenSizeX","gfx","width","screenSizeY","questBoxSize","questBoxMargin","gui","GUIWindow","frame","FlyQuest","super","fliesEaten","needToEat","flyEaten","character","ateThisFrame","foodName","generalState","wizardAnim","opacity","i","push","translate","x","w","y","h","tint","image","pop"],"version":3,"file":"index.4f5991a6.js.map"}