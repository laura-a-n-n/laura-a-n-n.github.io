{"mappings":"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","sources":["public/src/scene/general.js"],"sourcesContent":["function General() {\r\n  /* setup (っ◔◡◔)っ ❤ */\r\n  this.particularSetup = function() {};\r\n  this.particularFrame = function() {};\r\n  this.particularDraw = function() {};\r\n  this.earlySetup = function() {};\r\n\r\n  this.setup = function() {\r\n    // get injected properties\r\n    mgr = this.sceneManager;\r\n    gfx = mgr.gfx;\r\n    sfx = mgr.sfx;\r\n    pixelFont = mgr.pixelFont;\r\n    frogShader = mgr.frogShader;\r\n    hueVal = mgr.hueVal;\r\n    satVal = mgr.satVal;\r\n    valVal = mgr.valVal;\r\n    muted = mgr.prop.muted;\r\n\r\n    // canvas\r\n    calcWindowBounds();\r\n\r\n    // early setup\r\n    this.earlySetup();\r\n\r\n    // environment\r\n    this.envFunction();\r\n    envType = lilies.constructor.name;\r\n\r\n    // global controls\r\n    controlsEnabled = true;\r\n    puzzleMode = false;\r\n    snailPuzzle = false;\r\n    placingSnail = true;\r\n    muted = false;\r\n    levelFailed = false;\r\n    levelWon = false;\r\n    buttonPressed = false;\r\n\r\n    // create game!\r\n    let canvas = createCanvas(screenSizeX, screenSizeY);\r\n    canvas.parent('game-container');\r\n\r\n    // fade in!\r\n    fadeIn = 255;\r\n    fadingIn = true;\r\n\r\n    // frog drawer\r\n    pg = createGraphics(gfx.bby.width, gfx.bby.height, WEBGL);\r\n    pg.setAttributes('alpha', true);\r\n\r\n    this.particularSetup();\r\n\r\n    // sound\r\n    if (this.song != mgr.prop.song && (this.song !== undefined)) {\r\n      mgr.prop.song.stop();\r\n      mgr.prop.song = this.song;\r\n      mgr.prop.song.setVolume(mgr.prop.musicVol * this.songVol);\r\n      mgr.prop.song.loop();\r\n    }\r\n  }\r\n\r\n  this.enter = this.setup;\r\n\r\n  /* events (/◕ヮ◕)/ */\r\n\r\n  this.windowResized = function() {\r\n    calcWindowBounds();\r\n\r\n    if (player.hasQuest) player.questList[player.currentQuest].calcGUIBounds();\r\n    [cam.w, cam.h] = [screenSizeX, screenSizeY];\r\n    resizeCanvas(screenSizeX, screenSizeY);\r\n  }\r\n\r\n  this.mouseClicked = function(e) {\r\n\t\tif (snailPuzzle && placingSnail) {\r\n\t\t\tplacingSnail = false;\r\n\t\t\tcontrolsEnabled = true;\r\n      if (!cam.locked) {\r\n        cam.toggleLock(frog);\r\n      }\r\n\t\t}\r\n    else if (controlsEnabled && !frog.isJumping && !cl_lastClicked) {\r\n      frog.jumpNextFrame = true;\r\n    }\r\n    else if (player.quitReady) window.location.reload();\r\n  }\r\n\r\n  this.keyPressed = function() {\r\n\t\tif (snailPuzzle && (keyCode == UP_ARROW || keyCode == DOWN_ARROW)) {\r\n      if (frogs.length > 1) return;\r\n\t\t\tcurrentFrogType++;\r\n\t\t\tcurrentFrogType %= 2;\r\n      frog = player.instantiateCharacter();\r\n\t\t\tfrog.type = frogTypes[currentFrogType];\r\n\r\n\t\t}\r\n    else if (controlsEnabled) {\r\n      if (!frog.isJumping && !puzzleMode) {\r\n        if (keyCode == UP_ARROW) {\r\n          frog.type += 1;\r\n        } else if (keyCode == DOWN_ARROW) {\r\n          frog.type -= 1;\r\n        }\r\n      }\r\n\r\n      if (key == 'y') {\r\n        cam.toggleLock(frog);\r\n      } else if (key == 'u') {\r\n        cam.anchored = !cam.anchored;\r\n      } else if (key == 'Escape') {\r\n        //player.resetCharacter();\r\n        //frog = player.character;\r\n      } else if (key == 'h') {\r\n        cam.guiOptions['helpLines'] = !cam.guiOptions['helpLines'];\r\n      }\r\n\r\n      for (const letter in player.binds) {\r\n        if (key == letter.toLowerCase()) player.binds[letter]();\r\n      }\r\n    }\r\n\r\n    if (player.quitReady) window.location.reload();\r\n  }\r\n\r\n  this.mouseWheel = function(event) {\r\n    if (controlsEnabled) {\r\n      //cam.zoom(event.delta);\r\n      //frog.scale = cam.scale;\r\n      //disabled in demo!\r\n    }\r\n  }\r\n\r\n  this.frame = function() {\r\n    player.frame();\r\n\r\n    if (!player.character.tooHungry) {\r\n      frogs.forEach((frog) => frog.frame(cam));\r\n\r\n      for (const bug in bugs) {\r\n        bugs[bug].frame(frogs);\r\n\r\n        if (bugs[bug].destroyed) bugs.splice(bug, 1);\r\n      }\r\n\r\n      cam.frame();\r\n\r\n      this.particularFrame();\r\n    }\r\n  }\r\n\r\n  /* ~ other stuff ~ */\r\n  this.wizardAnim = function() {\r\n    frog.type = 0;\r\n    frog.drawType = false;\r\n    controlsEnabled = false;\r\n\r\n    wizard = new Frog(lilies, gfx['frogStand'], frog.number + 3,\r\n                      frog.lily + 3);\r\n    wizard.pointingLeft = true;\r\n    wizard.isBby = false;\r\n    frogs.push(wizard);\r\n\r\n    visibleFrogs = [0, 1];\r\n    wizard.jumpNextFrame = true;\r\n\r\n    mgr.prop.song.stop();\r\n    sfx.wizard.setVolume(.5 * mgr.prop.fxVol);\r\n    sfx.wizard.play();\r\n\r\n    wizard.special = function() {\r\n      if (wizard.stoppedJumping && wizard.number != frog.number + 1) {\r\n        wizard.jumpNextFrame = true;\r\n      } else if (wizard.number == frog.number + 1) {\r\n        wizard.deleteSpecial();\r\n        wizard.drawSpecial = true;\r\n        wizard.specialFrames = 0;\r\n\r\n        wizard.specialDraw = function() {\r\n          wizard.specialFrames += deltaTime / 1000;\r\n\r\n          image(gfx.alertBubble, gfx.alertBubble.width / 2, 0);\r\n\r\n          if (wizard.specialFrames > 5) {\r\n            // mgr.showScene(OpenLinear, {step: 1})\r\n            mgr.showScene(FactorsPuzzle, {specialLily: 9, initVals: [2, 3, 4, 5]});\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /* main loop ✨(っ◔︣◡◔᷅)っc(◕︣◡◕᷅c)✨ */\r\n\r\n  this.draw = function() {\r\n    this.frame();\r\n\r\n    /* ~ background ~ */\r\n    this.drawBackground(this.bg);\r\n\r\n    /* ~ lilies ~ */\r\n    lilies.draw();\r\n\r\n    /* ~ bugs ~ */\r\n    for (const bug of bugs) {\r\n      push();\r\n\r\n      camBugPos = cam.toCamCoords(bug.posX, bug.posY);\r\n      translate(...camBugPos);\r\n\r\n      image(bug.sprite, 0, 0, cam.scale * bug.dimX, cam.scale * bug.dimY);\r\n\r\n      pop();\r\n    }\r\n\r\n    /* ~ gui ~ */\r\n    player.draw();\r\n    \r\n    /* ~ frog ~ */\r\n    for (const frog of visibleFrogs) {\r\n      // all frogs!\r\n      frogs[frog].draw();\r\n    };\r\n\r\n    /* ~ fade in ~ */\r\n    if (fadingIn) {\r\n      background(0, fadeIn);\r\n\r\n      fadeIn -= deltaTime / 10;\r\n      fadingIn = fadeIn >= 0;\r\n    }\r\n\r\n    // level-specific draw\r\n    this.particularDraw();\r\n  }\r\n}\r\n\r\ngeneralState = new General();"],"names":["General","this","particularSetup","particularFrame","particularDraw","earlySetup","setup","mgr","sceneManager","gfx","sfx","pixelFont","frogShader","hueVal","satVal","valVal","muted","prop","calcWindowBounds","envFunction","envType","lilies","constructor","name","controlsEnabled","puzzleMode","snailPuzzle","placingSnail","levelFailed","levelWon","buttonPressed","createCanvas","screenSizeX","screenSizeY","parent","fadeIn","fadingIn","pg","createGraphics","bby","width","height","WEBGL","setAttributes","song","undefined","stop","setVolume","musicVol","songVol","loop","enter","windowResized","player","hasQuest","questList","currentQuest","calcGUIBounds","cam","w","h","resizeCanvas","mouseClicked","e","locked","toggleLock","frog","isJumping","cl_lastClicked","quitReady","window","location","reload","jumpNextFrame","keyPressed","keyCode","UP_ARROW","DOWN_ARROW","type","key","anchored","guiOptions","letter","binds","toLowerCase","frogs","length","currentFrogType","instantiateCharacter","frogTypes","mouseWheel","event","frame","character","tooHungry","forEach","bug","bugs","destroyed","splice","wizardAnim","drawType","wizard","Frog","number","lily","pointingLeft","isBby","push","visibleFrogs","fxVol","play","special","stoppedJumping","deleteSpecial","drawSpecial","specialFrames","specialDraw","deltaTime","image","alertBubble","showScene","FactorsPuzzle","specialLily","initVals","draw","drawBackground","bg","camBugPos","toCamCoords","posX","posY","translate","sprite","scale","dimX","dimY","pop","background","generalState"],"version":3,"file":"index.c4f75d18.js.map"}